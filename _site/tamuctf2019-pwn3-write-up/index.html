<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/post.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/scroll.css">
  <link rel="stylesheet" href="/css/typewriter.css">
  <link rel="stylesheet" href="/fontawesome/css/all.min.css">
  <link rel="shortcut icon" href="/img/jekyll/hack.png"/>
  <title>My pentest notes</title>
</head>
<body>


<div class="header">
  <div>
    <h3><span class="typewriter">My pentest notes</span></h3>
  </div>
</div>

<div class="nav">
  <ul class="text-source">
    <li> <a href="/">HOME</a> </li>
    <li> <a href="\list">POSTS</a> </li>
    <li> <a href="\form">SEARCH</a> </li>
  </ul>
</div>


<div class="row">
  <div class="leftcolumn">
    <div class="card">
  <h2 class="text-source">About Me</h2>
  <ul class="list-none">
    <li><i class="fas fa-user mb-08"></i> DanP</li>
    <li><i class="fas fa-map-marker-alt mb-08"></i> Brazil</li>
    <li><i class="fas fa-envelope mb-08"></i> 
    	<a class="decoration-none text-white" target="_blank" href="mailto:soaresdaniel487@gmail.com"> E-mail </a> 
    </li>
    <li><i class="fab fa-github"></i> <a class="decoration-none text-white" href="https://github.com/D4nPs" target="_blank">Github</a> </li>
    <li><i class="fab fa-linkedin"></i> <a class="decoration-none text-white" href="https://www.linkedin.com/in/danielspatricio/" target="_blank">Linkedin</a> </li>
  </ul>
</div>

    <div class="mt-2">
    <h4  class="text-white" style="padding-left: 25px">Share this:</h4>
    <div id="share-bar">

    <!-- <h5>Share this:</h5> -->

    <div class="share-buttons text-center">
        <a style="text-decoration: none;" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/tamuctf2019-pwn3-write-up/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Facebook" >
            <i class="fab fa-facebook share-button"></i>
        </a>

        <a style="text-decoration: none;" href="https://twitter.com/intent/tweet?text=TAMUCTF2019 PWN3 Write-up&url=http://localhost:4000/tamuctf2019-pwn3-write-up/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Twitter" >
            <i class="fab fa-twitter share-button"></i>
        </a>

        <a style="text-decoration: none;" href="http://www.reddit.com/submit?url=http://localhost:4000/tamuctf2019-pwn3-write-up/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Reddit" >
            <i class="fab fa-reddit-alien share-button"></i>
        </a>

        <a style="text-decoration: none;" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/tamuctf2019-pwn3-write-up/&title=TAMUCTF2019 PWN3 Write-up&summary=Hey Guys! This post i’ll be showing you how I managed to solve PWN3 challenge from TAMUCTF2019! Let’GO!&source=My pentest notes"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on LinkedIn" >
            <i class="fab fa-linkedin share-button"></i>
        </a>

        <a style="text-decoration: none;" href="mailto:?subject=TAMUCTF2019 PWN3 Write-up&amp;body=Check out this site http://localhost:4000/tamuctf2019-pwn3-write-up/"
            title="Share via Email" >
            <i class="fa fa-envelope share-button"></i>
        </a>
    </div>

</div>
    </div>
  </div>

  <div class="rightcolumn">
    <div class="card box-content">
    	
      <h2 class="text-source text-blue"> TAMUCTF2019 PWN3 Write-up </h2>
<h5> Hey Guys! This post i’ll be showing you how I managed to solve PWN3 challenge from TAMUCTF2019! Let’GO! </h5>
<h5> May, 3 2019 </h5>


      <p><small> <i> Tags: CTF | RATF | FLAG | CHALLENGE </i> </small></p>

<p>Hey Guys! This post i’ll be showing you how I managed to solve PWN3 challenge from TAMUCTF2019!
This was a standard stack execution where we had to insert our shellcode in the stack and point ou EIP there to execute it. Let’GO!</p>

<p class="text-center"><img src="/img/jekyll/1/ratf.png" alt="ratf" class="img-responsive" /></p>

<p class="text-center"><img src="/img/jekyll/1/example.png" alt="code example" class="img-responsive" /></p>

<p>Let’s execute the binary locally to see what happens.</p>

<p class="text-center"><img src="/img/jekyll/1/code1.png" alt="code example" class="img-responsive" /></p>

<p>After sending a lot of bytes we get a “seg fault” and that’s what we want. Using GDB let’s find out how many bytes we must send to control EIP.</p>

<figure class="highlight"><pre><code class="language-cmd" data-lang="cmd">gdb-peda$ pattern_create 400
'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%y'

Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x25416825 in ?? ()
gdb-peda$ pattern_search
Registers contain pattern buffer:
EBX+0 found at offset: 294
EBP+0 found at offset: 298
EIP+0 found at offset: 302
Registers point to pattern buffer:
[EAX] --&gt; offset 0 - size ~203
[ESP] --&gt; offset 306 - size ~94</code></pre></figure>

<p>Using pattern_search we discover that offset is 302 bytes long. Cool valuable information there, but where is our ESP? Since that value keeps changing when we connect via netcat ASLR is on, so it gets hard to know where to point to. So we need to discover what is the address that pops up when the program is executed.</p>

<p>Running a few times in different environments I noticed that we can use this address to determine the exact position of our ESP, because that address + 0x132 = $ESP</p>

<figure class="highlight"><pre><code class="language-mcd" data-lang="mcd">Starting program: /root/ctf/tamu/pwn3/pwn3 
Take this, you might need it on your journey 0xffffd01e!

gdb-peda$ x/5wx $esp
0xffffd150: 0x4d254137 0x41692541 0x25413825 0x6a25414e

So, by doing 0xffffd150 - 0xffffd01e = 0x132</code></pre></figure>

<p>Cool! Now we have everything set, let’s create our exploit.</p>

<p>Got my shellcode from shellstorm.com</p>

<p class="text-center"><img src="/img/jekyll/1/code2.png" alt="code example" class="img-responsive" /></p>

<p>Hope you guys enjoyed it!</p>

<p>by me</p>


      <div style="margin-top: 50px">
      <div id="share-bar">

    <!-- <h5>Share this:</h5> -->

    <div class="share-buttons text-center">
        <a style="text-decoration: none;" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/tamuctf2019-pwn3-write-up/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Facebook" >
            <i class="fab fa-facebook share-button"></i>
        </a>

        <a style="text-decoration: none;" href="https://twitter.com/intent/tweet?text=TAMUCTF2019 PWN3 Write-up&url=http://localhost:4000/tamuctf2019-pwn3-write-up/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Twitter" >
            <i class="fab fa-twitter share-button"></i>
        </a>

        <a style="text-decoration: none;" href="http://www.reddit.com/submit?url=http://localhost:4000/tamuctf2019-pwn3-write-up/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Reddit" >
            <i class="fab fa-reddit-alien share-button"></i>
        </a>

        <a style="text-decoration: none;" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/tamuctf2019-pwn3-write-up/&title=TAMUCTF2019 PWN3 Write-up&summary=Hey Guys! This post i’ll be showing you how I managed to solve PWN3 challenge from TAMUCTF2019! Let’GO!&source=My pentest notes"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on LinkedIn" >
            <i class="fab fa-linkedin share-button"></i>
        </a>

        <a style="text-decoration: none;" href="mailto:?subject=TAMUCTF2019 PWN3 Write-up&amp;body=Check out this site http://localhost:4000/tamuctf2019-pwn3-write-up/"
            title="Share via Email" >
            <i class="fa fa-envelope share-button"></i>
        </a>
    </div>

</div>
      </div>
      
    </div>
  </div>

</div>

<div class="footer">
  <h5>© Copyright 2020 - All Rights Reserved - DanP</h5>
</div>


</body>
</html>
